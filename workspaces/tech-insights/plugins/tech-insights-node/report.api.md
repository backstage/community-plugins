## API Report File for "@backstage-community/plugin-tech-insights-node"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts
import { AuthService } from '@backstage/backend-plugin-api';
import { BulkCheckResponse } from '@backstage-community/plugin-tech-insights-common';
import { Check } from '@backstage-community/plugin-tech-insights-common';
import { CheckLink } from '@backstage-community/plugin-tech-insights-common';
import { CheckResult } from '@backstage-community/plugin-tech-insights-common';
import { CompoundEntityRef } from '@backstage/catalog-model';
import { Config } from '@backstage/config';
import { DateTime } from 'luxon';
import { DiscoveryService } from '@backstage/backend-plugin-api';
import { Duration } from 'luxon';
import { DurationLike } from 'luxon';
import { ExtensionPoint } from '@backstage/backend-plugin-api';
import { FactSchema } from '@backstage-community/plugin-tech-insights-common';
import { HumanDuration } from '@backstage/types';
import { InsightFacts } from '@backstage-community/plugin-tech-insights-common';
import { JsonValue } from '@backstage/types';
import { LoggerService } from '@backstage/backend-plugin-api';
import { ServiceRef } from '@backstage/backend-plugin-api';
import { UrlReaderService } from '@backstage/backend-plugin-api';

// @public
export type CheckValidationResponse = {
  valid: boolean;
  message?: string;
  errors?: unknown[];
};

// @public
export interface FactChecker<
  CheckType extends Check,
  CheckResultType extends CheckResult,
> {
  getChecks(): Promise<CheckType[]>;
  runChecks(entity: string, checks?: string[]): Promise<CheckResultType[]>;
  validate(check: CheckType): Promise<CheckValidationResponse>;
}

// @public
export interface FactCheckerFactory<
  CheckType extends Check,
  CheckResultType extends CheckResult,
> {
  // (undocumented)
  construct(
    repository: TechInsightsStore,
  ): FactChecker<CheckType, CheckResultType>;
}

// @public
export type FactLifecycle = TTL | MaxItems;

// @public
export interface FactRetriever<
  TContext extends FactRetrieverContext = FactRetrieverContext,
> {
  description?: string;
  entityFilter?:
    | Record<string, string | symbol | (string | symbol)[]>[]
    | Record<string, string | symbol | (string | symbol)[]>;
  handler: (ctx: TContext) => Promise<TechInsightFact[]>;
  id: string;
  schema: FactSchema;
  title?: string;
  version: string;
}

// @public
export type FactRetrieverContext<TExtension = {}> = {
  config: Config;
  discovery: DiscoveryService;
  logger: LoggerService;
  auth: AuthService;
  urlReader: UrlReaderService;
  entityFilter?:
    | Record<string, string | symbol | (string | symbol)[]>[]
    | Record<string, string | symbol | (string | symbol)[]>;
} & TExtension;

// @public
export type FactRetrieverRegistration<
  TContext extends FactRetrieverContext = FactRetrieverContext,
> = {
  factRetriever: FactRetriever<TContext>;
  cadence?: string;
  timeout?: Duration | HumanDuration;
  lifecycle?: FactLifecycle;
  initialDelay?: Duration | HumanDuration;
};

// @public (undocumented)
export interface FactRetrieverRegistry {
  // (undocumented)
  get(retrieverReference: string): Promise<FactRetrieverRegistration>;
  // (undocumented)
  getSchemas(): Promise<FactSchema[]>;
  // (undocumented)
  listRegistrations(): Promise<FactRetrieverRegistration[]>;
  // (undocumented)
  listRetrievers(): Promise<FactRetriever[]>;
  // (undocumented)
  register<TContext extends FactRetrieverContext = FactRetrieverContext>(
    registration: FactRetrieverRegistration<TContext>,
  ): Promise<void>;
}

// @public
export type FactSchemaDefinition = Omit<FactRetriever, 'handler'>;

// @public
export type FlatTechInsightFact = TechInsightFact & {
  id: string;
};

// @public
export type MaxItems = {
  maxItems: number;
};

// @public
export type PersistenceContext = {
  techInsightsStore: TechInsightsStore;
};

// @public @deprecated
export interface TechInsightCheck {
  description: string;
  factIds: string[];
  failureMetadata?: Record<string, any>;
  id: string;
  links?: CheckLink[];
  metadata?: Record<string, any>;
  name: string;
  successMetadata?: Record<string, any>;
  type: string;
}

// @public
export interface TechInsightCheckRegistry<CheckType extends Check> {
  // (undocumented)
  get(checkId: string): Promise<CheckType>;
  // (undocumented)
  getAll(checks: string[]): Promise<CheckType[]>;
  // (undocumented)
  list(): Promise<CheckType[]>;
  // (undocumented)
  register(check: CheckType): Promise<CheckType>;
}

// @public
export type TechInsightFact = {
  entity: {
    namespace: string;
    kind: string;
    name: string;
  };
  facts: Record<
    string,
    | number
    | string
    | boolean
    | DateTime
    | number[]
    | string[]
    | boolean[]
    | DateTime[]
    | JsonValue
  >;
  timestamp?: DateTime;
};

// @public (undocumented)
export interface TechInsightsFactCheckerFactoryExtensionPoint {
  // (undocumented)
  setFactCheckerFactory<
    CheckType extends Check,
    CheckResultType extends CheckResult,
  >(
    factory: FactCheckerFactory<CheckType, CheckResultType>,
  ): void;
}

// @public
export const techInsightsFactCheckerFactoryExtensionPoint: ExtensionPoint<TechInsightsFactCheckerFactoryExtensionPoint>;

// @public (undocumented)
export interface TechInsightsFactRetrieverRegistryExtensionPoint {
  // (undocumented)
  setFactRetrieverRegistry(registry: FactRetrieverRegistry): void;
}

// @public
export const techInsightsFactRetrieverRegistryExtensionPoint: ExtensionPoint<TechInsightsFactRetrieverRegistryExtensionPoint>;

// @public (undocumented)
export interface TechInsightsFactRetrieversExtensionPoint {
  // (undocumented)
  addFactRetrievers(factRetrievers: Record<string, FactRetriever>): void;
}

// @public
export const techInsightsFactRetrieversExtensionPoint: ExtensionPoint<TechInsightsFactRetrieversExtensionPoint>;

// @public (undocumented)
export interface TechInsightsPersistenceContextExtensionPoint {
  // (undocumented)
  setPersistenceContext(context: PersistenceContext): void;
}

// @public
export const techInsightsPersistenceContextExtensionPoint: ExtensionPoint<TechInsightsPersistenceContextExtensionPoint>;

// @public
export interface TechInsightsService {
  // (undocumented)
  getAllChecks(): Promise<Check[]>;
  // (undocumented)
  getFacts(entity: CompoundEntityRef, facts: string[]): Promise<InsightFacts>;
  // (undocumented)
  getFactSchemas(): Promise<FactSchema[]>;
  // (undocumented)
  runBulkChecks(
    entities: CompoundEntityRef[],
    checks?: Check[],
  ): Promise<BulkCheckResponse>;
  // (undocumented)
  runChecks(
    entityParams: CompoundEntityRef,
    checks?: string[],
  ): Promise<CheckResult[]>;
}

// @public
export const techInsightsServiceRef: ServiceRef<
  TechInsightsService,
  'plugin',
  'singleton'
>;

// @public
export interface TechInsightsStore {
  // (undocumented)
  getEntities(): Promise<CompoundEntityRef[]>;
  getFactsBetweenTimestampsByIds(
    ids: string[],
    entity: string,
    startDateTime: DateTime,
    endDateTime: DateTime,
  ): Promise<{
    [factRef: string]: FlatTechInsightFact[];
  }>;
  // (undocumented)
  getLatestFactsByIds(
    ids: string[],
    entity: string,
  ): Promise<{
    [factRef: string]: FlatTechInsightFact;
  }>;
  getLatestSchemas(ids?: string[]): Promise<FactSchema[]>;
  insertFacts(options: {
    id: string;
    facts: TechInsightFact[];
    lifecycle?: FactLifecycle;
  }): Promise<void>;
  insertFactSchema(schemaDefinition: FactSchemaDefinition): Promise<void>;
}

// @public
export type TTL = {
  timeToLive: DurationLike;
};

// (No @packageDocumentation comment for this package)
```
